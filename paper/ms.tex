\documentclass[useAMS, usenatbib, preprint, 12pt]{aastex}
\usepackage{cite, natbib}
\usepackage{float}
\usepackage{epsfig}
\usepackage{cases}
\usepackage[section]{placeins}
\usepackage{graphicx, subfigure}
\usepackage{color}
\usepackage{bm}
\usepackage{enumerate}
\usepackage{pdflscape}
\usepackage{eqnarray}

\newcommand{\racomment}[1]{{\color{red}#1}}

% Affiliations
\newcommand{\columbia}{1}
\newcommand{\simons}{2}
\newcommand{\nyu}{3}
\newcommand{\cca}{4}
\newcommand{\mpia}{5}

% Missions
\newcommand{\Kepler}{{\it Kepler}}
\newcommand{\kepler}{\Kepler}
\newcommand{\kic}{\KIC}
\newcommand{\KIC}{\KIC}
\newcommand{\corot}{{\it CoRoT}}
\newcommand{\Ktwo}{{\it K2}}
\newcommand{\ktwo}{\Ktwo}
\newcommand{\TESS}{{\it TESS}}
\newcommand{\tess}{{\it TESS}}
\newcommand{\LSST}{{\it LSST}}
\newcommand{\lsst}{{\it LSST}}
\newcommand{\Wfirst}{{\it Wfirst}}
\newcommand{\wfirst}{{\it Wfirst}}
\newcommand{\SDSS}{{\it SDSS}}
\newcommand{\sdss}{{\it SDSS}}
\newcommand{\PLATO}{{\it PLATO}}
\newcommand{\plato}{{\it PLATO}}
\newcommand{\TGAS}{{\it TGAS}}
\newcommand{\tgas}{{\it TGAS}}
\newcommand{\APOGEE}{{\it APOGEE}}
\newcommand{\apogee}{{\it APOGEE}}
\newcommand{\gaia}{{\it Gaia}}
\newcommand{\Gaia}{{\it Gaia}}
\newcommand{\rave}{{\it RAVE}}
\newcommand{\Rave}{{\it RAVE}}

% Stellar parameters
\newcommand{\Teff}{$T_{\mathrm{eff}}$}
\newcommand{\teff}{$T_{\mathrm{eff}}$}
\newcommand{\FeH}{[Fe/H]}
\newcommand{\feh}{[Fe/H]}
\newcommand{\Av}{$A_v$}
\newcommand{\av}{$A_v$}
\newcommand{\logg}{log \emph{g}}
\newcommand{\dnu}{$\Delta \nu$}
\newcommand{\numax}{$\nu_{\mathrm{max}}$}

% Common expressions
\newcommand{\ie}{{\it i.e.}}
\newcommand{\eg}{{\it e.g.}}
\newcommand{\etal}{{\it et al.}}

% Paper-specific
\newcommand{\nkictgas}{2000}

\begin{document}

\title{A coherent and comprehensive dating system for stars in the Milky Way}

\author{%
    Ruth Angus\altaffilmark{\columbia,}\altaffilmark{\simons},
   David Hogg\altaffilmark{\nyu,}\altaffilmark{\cca,}\altaffilmark{\mpia},
    \etal
   % Melissa Ness\altaffilmark{\mpia},
   % David Kipping\altaffilmark{\columbia}, \etal
}

\altaffiltext{\columbia}{Department of Astronomy, Columbia
University, NY, NY}
\altaffiltext{\simons}{Simons Fellow, RuthAngus@gmail.com}
\altaffiltext{\nyu}{Center for Cosmology and Particle Physics, New York
University, NY, NY}
\altaffiltext{\mpia}{Max Planck Institute of Astronomy, Heidelberg, Germany}
\altaffiltext{\cca}{Center for Computational Astrophysics, Flatiron Institute,
NY, NY}

\begin{abstract}
% Aims
Stellar age underpins a wide range of astronomical applications but
remains one of the most challenging stellar properties to infer.
% Method
Competing dating methods with different observational inputs often produce
    wildly inconsistent age estimates.
In this work we attempt to combine multiple methods into one coherent model.
We combine apparent magnitudes and colour indices, typically used to infer an
    age using stellar evolutionary tracks alone, with other age proxies:
    rotation period and vertical action.
We identify a sample of stars with rotation periods, colours, spectroscopic
    parameters and kinematics to calibrate this dating method.
% Results
\end{abstract}


\section{Introduction}
\label{sec:intro}

The processes behind the formation of the Milky Way and the objects within it
are some of the most elusive and complicated topics in astronomy today.
These topics are connected by a common theme: stellar ages.
Stellar ages provide the key to understanding the evolution of all
astrophysical objects.
For main sequence (MS) stars however, age is a difficult property to infer.
This is predominantly because hydrogen burning stars do not change appreciably
during their time spent on the MS: a star like the Sun will grow in
luminosity by around a factor of two before becoming a red giant.
Luminosity is therefore not a very sensitive probe of age.
As explained further later in this paper: the Sun's rotation period will vary
by almost an order of magnitude over its MS lifetime, thus rotation
period is a much more sensitive age proxy than luminosity or temperature.

In addition to the difficulties imposed by the slow timescale for variability
within MS stars, different dating methods often produce inconsistent
predictions for the age of a star.
For example, an asteroseismic age will not necessarily agree with a isochronal
or rotational age.
This is in part because the underlying processes generating the evolution of
the observable properties are different and in part because our understanding
of the underlying physics is flawed or incomplete.
The various available dating methods can be categorised by the underlying
physical process they trace.
For example, evolutionary models track the radial extent of the
hydrogen-burning core and age-rotation relations model the evolving state of
the internal magnetic dynamo.
In addition, dating methods can be classified by their level of empiricism,
\ie\ the number of free parameters that need to tuned when fitting the models
to the data.
The physics behind the evolving luminosity and effective temperature of a star
as a result of core hydrogen burning is, for example, very well understood and
does not need calibrating; physics determine these models.
On the other hand, magnetic activity evolution is poorly understood and must
be calibrated using available data.
In table \ref{tab:dating_methods} we provide an overview of various dating
methods, the main observables associated with them, the underlying physics
driving the changing observables, the types of star the method applies to and
the empirical or physical nature of the model.

\begin{landscape}
\begin{table}
\begin{center}
\caption{A list of all dating methods with the types of stars they apply to
    and their effective or physical natures.}
\begin{tabular}{lcccc}
    Method & Observable & Underlying cause & Applicable to... & Effective or
    Physical model? \\
    \hline
    Rotation & $P_{\mathrm{rot}}$ & Magnetic activity & $<$ 4 Gyr, MS &
    Effective \\
    Activity & Radio, H$\alpha$ \& X-ray & Magnetic activity & $<$
    5 Gyr, low mass & Effective \\
    Time variability & Time variability & ? & ? & ? \\
    \hline
    Isochrones & $T_{\mathrm{eff}}$, $M_v$ & Core/shell fusion &
    Subgiants/giants & Physical (model dependent) \\
    Spectroscopic twins & Spectra & ? & ? & ? \\
    \hline
    Asteroseismology & Frequencies & Core/shell fusion & Old, low
    mass, Giants & Physical (model dependent) \\
    \hline
    White dwarf cooling & $M_v$ & Cooling & WDs (\& companions) &
    Physical (1 free parameter) \\
    \hline
    $J_z$, $J_{\phi}$, $J_r$ & Position \& velocity & Dynamic heating & Disk
    stars & Physical (1 free parameter) \\
    Galactocentric position & Position & Formation history &
    All stars & Effective \\
    Coeval pairs & Position \& velocity & Disruption & $<$ 1 Gyr, disk &
    0 free parameters \\
    Open Clusters & Disruption & Positions \& velocities & $<$ 2 Gyr &
    0 free parameters \\
    Exoplanet dynamics & Stability \& eccentricity & Interactions & $<$ 500
    Myrs & 0 free parameters \\
    \hline
    C/N ratio & C/N ratio & Convective processes & Red giants, A \& F &
    Effective \\
    Chemical abundances & Abundances & ISM enrichment & $>$ 8 Gyr?
    & Effective \\
    Lithium abundance & L abundance & $L$ depletion & $<$ 500
    Myrs? & Effective \\
    $[Y/Mg]$ & $[Y/Mg]$ & Enrichment & ? & Effective \\
    \hline
    Nuclear isotopes & ? & ? & ? & ? \\
    Unusual HRD objects & $T_{\mathrm{eff}}$, $M_v$ & Mergers, ? & Special
    cases & ? \\
    Universe age & All of the above & Finite age of the Universe &
    All stars & 0 free parameters \\
\end{tabular}
\end{center}
\end{table}
\label{tab:dating_methods}
\end{landscape}

In this paper we focus on four of these dating methods: rotation,
asteroseismology, stellar evolution models and galactic kinematics.
A brief overview of each of these methods is provided in the following
sections.

\subsection{Rotation-Dating}
\label{sec:rotation}

Main sequence (MS) stars comprise the majority of our galaxy but their ages
are notoriously difficult to measure.
Their positions on the HR diagram don't change significantly during their
    hydrogen burning lifetimes, a fact that is convenient for life on Earth
    but inconvenient for galactic archaeologists.
Now, due to the abundance of rotation periods for MS stars provided by Kepler
    and to-be provided by TESS, LSST and Wfirst, rotation-dating is the most
    readily available, precise method for inferring stellar ages.
Rotation-dating works well for young stars but a question mark still hangs
    over its accuracy for stars older than the Sun.
Recent results show that old \kepler\ asteroseismic stars rotate more rapidly
    than expected given their age \citep[\eg][]{Angus2015, Vansaders2016,
    Metcalfe2016}.
This has been attributed to an evolving magnetic dynamo: as stars reach a
    critical Rossby number (the ratio of rotation period to the convective
    overturn timescale), their magnetic field `switches off' and stars
    maintain a consistent rotation period after that time.
Whilst this physical explanation produces a model that fits the data, it
    is driven by observations, not theory, and other explanations could
    provide an answer.
The data sets typically used to test the age-rotation relations are highly
    heterogeneous and each set has its own detection and selection biases.
For example, asteroseismology favours quiet stars whereas rotation periods are
    easiest to measure for active stars.

% A history of rotation-dating.
The phenomenon of magnetic braking in MS stars was first observed almost fifty
years ago by \citet{Skumanich1972} who observed that the rotation periods of
the Sun and young cluster stars seemed to decay with the square-root of time.
Later, a mass-dependence was added to the relation between age and rotation
period --- less massive stars lose angular momentum faster than more massive
ones.
\citet{Kawaler1988} derived a formalism for this angular momentum loss and his
relation depended on the mass loss rate, the ....
More recently, \citet{Barnes2003} demonstrated that a simple relation could be
used to describe `gyrochronology', the method of rotation-dating, and further
works \citep[\eg][]{Barnes2007, Mamajek2008, Barnes2010, Meibom2011},
continue to demonstrate that the relation between rotation period and age
holds true while theorists \citep[\eg][]{Matt2012, Epstein2014} modify and
extend the efforts to produce physical models of this phenomenon.

Not only do a number of dating methods exists, several different models are
often available for the same dating method.
In the case of rotation-dating...

\racomment{What happens when you can't measure a rotation period?}
\racomment{What about the difference in physics that you are investigating?}

\subsection{Asteroseismology}

\subsection{Stellar Evolution models}
The ongoing physical processes in the core of a star is reflected externally
by an increase in luminosity and temperature.
As hydrogen is converted to helium via nuclear fusion in the core, the mass
fraction, etc, etc.
Leading to etc, etc.


\subsection{Galactic Dynamics}

The age-velocity dispersion relations are relatively well studied and based on
simple physics.
There is evidence to suggest that stars in the Milky Way form in the thin disc
of the galaxy with relatively small vertical velocities and angular momenta
\racomment{add citations}.
As time passes these stars are scattered via close encounters with other
stars and interactions with galactic spiral arms.
The more time passes, the more scattering events, and stars slowly accumulate
angular momentum in the vertical direction, known as vertical action.
This results in a slow heating of stellar orbits.
Older stars can be identified in Gaia DR1 by integrating their orbits in the
potential of the Milky Way to convert their proper motions, positions and
parallaxes into vertical actions.
It is the {\it dispersion} in vertical action that truly traces age, far
better than vertical action itself.
However for single stars only the individual's vertical action is available.
Nonetheless, $J_z^2$ increases over time for any given star, and is a weak
tracer of age.
When studying populations of stars, the vertical action dispersion can be used
to infer their age relatively precisely (to within 2 Gyr
\racomment{Ruth, check this}).
However for single stars vertical action can only constrain ages to within 4
Gyr.

This paper is laid out as follows.
% In \textsection \ref{sec:dating_methods} we provide an overview of each dating
% method used in this paper and demonstrate their inconsistency in age
% predictions.
In \textsection \ref{sec:data} we describe the data used to calibrate our new
model, which is described in \textsection \ref{sec:method}.
In \textsection \ref{sec:results} we present a new catalogue of ages.

\section{Data}
\label{sec:data}
We assembled a sample of stars that have at least two of the four dating
methods available.
Our main asteroseismic sample targets comprise the $~$500 short cadence
\kepler\ prime targets.
These stars all have light curves and therefore rotation periods (or potential
rotation periods).
The majority are also in Gaia DR1, therefore have parallaxes, positions and
2-dimensional velocities, which can provide constraints on their vertical
actions.
A subset of these stars have spectroscopic information and therefore make
excellent isochronal targets.
Our main rotation sample is the \nkictgas\ stars in both the \kepler\ input
catalogue (KIC) and \TGAS.
These stars have potential rotation periods, parallaxes, positions and
2-dimensional velocities.
Some of these stars, particularly those with confirmed planets, also have
spectroscopic information and could provide isochronal ages.
Our main isochronal data set is the intersection of the \apogee\ and \rave\
catalogues with \tgas.
Relatively precise isochronal ages can be inferred from the spectroscopic
stellar properties of these stars, the majority which have ages from {\it the
cannon} \citep{Ness2015, Casey2016}.
They also have \gaia\ parallaxes, positions and proper motions as well as
radial velocities, providing vertical actions calculated from the full
3-dimensional phase-space.

\begin{landscape}
\begin{table}
\begin{center}
\caption{A summary of the data sets used in this project}
\begin{tabular}{lccc}
    Sample & Catalogue intersection &  Methods available \\
    \hline
    Asteroseismic & \citet{Chaplin2014} \& TGAS & Asteroseismology, rotation,
    isochrones, dynamics \\
    Rotational & KIC \& TGAS & Rotation, isochrones, dynamics \\
    Isochronal & RAVE, APOGEE \& TGAS & Isochrones, dynamics \\
\end{tabular}
\end{center}
\end{table}
\label{tab:data}
\end{landscape}

\section{Method}
\label{sec:method}

{\tt chronometer} extends isochrone fitting by simultaneously fitting an
age-rotation relation and a age-velocity dispersion relation to stars with
photometric colors, rotation periods and Gaia proper motions.
It combines the information available from these three dating techniques, thus
providing more accurate ages than any one of the techniques alone.

The accuracy of ages calculated with {\tt chronometer} still relies on the
rotational and kinematic age relations being correct.
As discussed above, the performance of the age-rotation relations for old
stars has been called into question in the last few years \citep{Angus2015,
Vansaders2016, Metcalfe2016}.
A simple straight-line model for rotational age does not reproduce the ages
predicted by asteroseismology for stars older than the Sun.
This phenomenon is attributed to a transitioning magnetic dynamo at a critical
Rossby number, $Ro$, of 2.6, the solar value \citep{Vansaders2016}.
As rotation periods slow, $Ro$ decreases until it hits the critical value and
magnetic braking switches off: stars maintain their rotation period from that
point onward.
This restricts the applicability of gyrochronology to young, rapidly rotating
stars.
This hypothesis is supported by the existing data, however these data are
sparse~---~the analyses demonstrating the discrepancies were conducted on the
small number of main sequence, Solar-like oscillators observed by Kepler in
short cadence mode with detectable rotation periods: a sample size of around
20 \racomment{Ruth - check this number}.
% Furthermore, asteroseismology favors stars with low surface gravities since
% they show the largest amplitudes of oscillation and the majority of stars in
% this sample were slightly evolved.
A larger sample of old main sequence stars with precise ages is required to
confirm and further characterize the Rossby saturation mechanism introduced by
\citep{Vansaders2016} which is currently supported by the Kepler data.
However, old main sequence stars are difficult to age-date with any other
method than asteroseismology.
We propose use the age gradients in the kinematic properties of stars to
confirm the Rossby saturation effect.

A simple test will allow us to distinguish between two magnetic braking
scenarios in MS stars: the continuous scenario in which stars begin magnetic
braking at zero-age main sequence and continue until main sequence turn off,
and the transition scenario in which stars stop braking at a critical Rossby
number.
This test involves computing rotation-based ages for stars observed by both
Kepler and Gaia.
Each star will have ages computed using the continuous scenario and the
transition scenario.
The vertical action dispersion will then be calculated for groups of stars
with similar rotational age, producing two vertical action-age relations.
The vertical action dispersion will also be calculated for red giants observed
by APOGEE with ages from the Cannon \citep{Ness2015}, observed by Gaia.
This red giant vertical action-age relation will serve as our "ground truth"
since these ages are relatively robust and well calibrated with asteroseismic
giants.
We will compare the both the $\sigma_{J_z}$-age relation for the continuous
scenario and the $\sigma_{J_z}$-age relation for the transition scenario with
the red giant $\sigma_{J_z}$-age relation.
This test will reveal whether continuous magnetic braking or transitional
magnetic braking provides a better description of the data.

This test will allow us to select an appropriate age rotation relation to be
used in {\tt chronometer}, our new age-dating method for MS stars.
{\tt chronometer} combines the following dating methods: gyrochronology,
isochrone fitting, asteroseismology and galactic kinematics into one model by
simply summing the log-likelihoods of the three different models.

We combine the following dating methods: gyrochronology, isochrone fitting,
asteroseismology and galactic kinematics into one model.
In classical isochrone fitting, one might calculate the probability of age
$A$, mass $M$, \feh, distance $D$ and extinction \av, given a set of
apparent magnitudes in different filters, \eg\ $M_V$, $M_J$ and $M_K$.
This can be written
\begin{eqnarray}
    &&p(A, M, [Fe/H], D, A_v | M_V, M_J, M_K) \\ \nonumber
    \propto &&p(M_v, M_J, M_K | A, M, [Fe/H], D, A_v) \\ \nonumber
    &&p(A)p(M)p([Fe/H])p(D)p(A_v).
\end{eqnarray}
There are no free parameters in the model here --- the model is entirely
determined by physics and does not need to be calibrated further.
Similarly, in classical gyrochronology, one might calculate the probability of
age given rotation period and $B-V$ colour,
\begin{equation}
    p(A | P_{rot}, B-V) \propto p(P_{rot}, B-V | A)p(A)
\end{equation}
In a gyrochronology model however our understanding of the physics is
incomplete and some free parameters must be calibrated.
In the \citet{Barnes2003} gyrochronology parameterisation, $A =
P_{\mathrm{rot}}^{1/n} - (B-V-0.4)^{b/n}$, these free parameters are $a$, $b$
and $n$.
During a calibration exercise, the observables, $A$, $P_{rot}$ and $B-V$ will
be known and the parameters, $a$, $b$ and $n$ will be inferred,
\begin{equation}
    p(a, b, n | \{A\}, \{P_{rot}\}, \{B-V\}) \propto \{p(A\}, \{P_{rot}\},
    \{B-V\} | a, b, n) p(a)p(b)p(n).
\end{equation}
The vertical action-age relation, $A = \alpha (\sigma_{Jz}^2)^\beta$,
also has free parameters that must be calibrated using observations.
These free parameters, $\alpha$ and $\beta$ can again be calibrated via
\begin{equation}
    p(\alpha, \beta | \{A\}, \{J_z\}) \propto p(\{A\}, \{J_z\} | \alpha,
    \beta) p(\alpha, \beta).
\end{equation}

The unique aspect of our analysis is to combine inference over ages with
calibration of the free parameters in the gyrochronology and vertical
action-age relations:
\begin{eqnarray}
    &&p(\{A\}, \{M\}, \{[Fe/H]\}, \{D\}, \{A_v\}, a, b, n, \alpha, \beta|
    \{M_V\}, \{M_J\}, \{M_K\}, \{P_{rot}\}, \{B-V\}, \{J_z\}) \\ \nonumber
    \propto &&p(\{M_v\}, \{M_J\}, \{M_K\}, \{P_{rot}\},
    \{B-V\}, \{J_z\} | \{A\}, \{M\}, \{[Fe/H]\}, \{D\}, \{A_v\}, a, b, n,
    \alpha, \beta) \\ \nonumber
    &&p(A, M, [Fe/H], D, A_v, a, b, n, \alpha, \beta).
\end{eqnarray}
We can use conditional independence to break this down further into the
following:
\begin{eqnarray}
    &&p(\{A\}, \{M\}, \{[Fe/H]\}, \{D\}, \{A_v\}, a, b, n, \alpha, \beta|
    M_V, M_J, M_K,
    \{P_{rot}\}, \{B-V\}, \{J_z\}) \\  \nonumber
    \propto &&p(\{M_v\}, \{M_J\}, \{M_K\} | \{A\}, \{M\}, \{[Fe/H]\}, \{D\},
    \{A_v\})
    p(A)p(M)p([Fe/H])p(D)p(A_v) \\ \nonumber
    &&p(\{P_{rot}\}, \{B-V\}, a, b, n | A)p(a)p(b)p(n) \\ \nonumber
    &&p(\{J_z\}, \alpha, \beta | \{A\}) p(\alpha)p(\beta).
\end{eqnarray}
In other words
\begin{eqnarray}
    &&p(\mathrm{Ages~\&~other~parameters}|\mathrm{observables}) \\
    \propto &&\mathcal{L}_{\mathrm{isochronal~age}} \times
    \mathcal{L}_{\mathrm{gyro~age}} \times
    \mathcal{L}_{\mathrm{kinematic~age}} \\
    && \times p(\mathrm{Ages~\&~other~parameters})
\end{eqnarray}.
We can multiply the likelihoods together by making the assumption that the
probabilities are conditionally independent, \ie\ a gyrochronology age depends
only on rotation period and colour, not proper motion, for example.
In reality this assumption is not valid because gyrochronology ages do depend
on \logg, \teff\ and \feh.
\racomment{How do we get around this!?}

We explore the parameter space via Gibbs sampling.
Gibbs sampling is a variation of MCMC that makes use of conditional
independence within the problem to reduce dimensionality.
It is often used in hierarchical inference problems such as this, where one
has a set of global parameters ($a$, $b$, $n$, $\alpha$ \& $\beta$) and sets
of per-object parameters ($\{A\}$, $\{M\}$, $\{[Fe/H]\}$, $\{D\}$, $\{A_v\}$).
Instead of updating all parameters simultaneously as in Metropolis,
Metropolis-Hastings, affine invariant \citep{Goodman2010}, nested, Hamiltonian,
and many other sampling algorithms, in Gibbs sampling, subsets of parameters
are updated at a time.
For example, the gyrochronology parameters will be updated, then the kinematic
parameters, then the isochronal parameters for star 1, then star 2, etc.
Since the number of parameters is $N_{gyro} + N_{kinematic} + N_{iso} \times
N_{stars}$, the number of parameters grows rapidly as stars are added.

As an example, take the Sun: a star with temperature $5777K$, $ \log(g) =
4.44$ $[Fe/H] = 0.0$ and $P_{rot} = 26$ days.

In order to establish the level of inconsistency between dating methods, we
first compare predictions for each of the above data sets.
This is purely an illustrative test as these dating methods are not always
independent, for example many rotation-dating models are calibrated using
asteroseismic age predictions.
For the asteroseismic sample we find that

\section{Results and Discussion}
\label{sec:results}

\section{Conclusions}

% acknowledgements
This research was funded by the Simons Foundation.
Some of the data presented in this paper were obtained from the Mikulski
Archive for Space Telescopes (MAST).
STScI is operated by the Association of Universities for Research in
Astronomy, Inc., under NASA contract NAS5-26555.
Support for MAST for non-HST data is provided by the NASA Office of Space
Science via grant NNX09AF08G and by other grants and contracts.
This paper includes data collected by the Kepler mission. Funding for the
Kepler mission is provided by the NASA Science Mission directorate.
\racomment{Add Gaia sprint, TGAS \& Apogee acknowledgements.}

\bibliographystyle{plainnat}
\bibliography{chronometer}

\end{document}
